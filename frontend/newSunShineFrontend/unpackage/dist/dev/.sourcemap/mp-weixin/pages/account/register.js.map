{"version":3,"file":"register.js","sources":["pages/account/register.vue","../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWNjb3VudC9yZWdpc3Rlci52dWU"],"sourcesContent":["<template>\r\n  <view class=\"register-container\">\r\n    <view class=\"register-header\">\r\n      <text class=\"register-title\">用户注册</text>\r\n    </view>\r\n    \r\n    <view class=\"register-form\">\r\n      <view class=\"form-group\">\r\n        <text class=\"form-label\">用户名</text>\r\n        <input \r\n          type=\"text\" \r\n          v-model=\"formData.username\" \r\n          placeholder=\"请输入用户名\" \r\n          class=\"form-input\"\r\n        />\r\n      </view>\r\n      \r\n      <view class=\"form-group\">\r\n        <text class=\"form-label\">密码</text>\r\n        <input \r\n          type=\"password\" \r\n          v-model=\"formData.password\" \r\n          placeholder=\"请输入密码\" \r\n          class=\"form-input\"\r\n        />\r\n      </view>\r\n      \r\n      <view class=\"form-group\">\r\n        <text class=\"form-label\">确认密码</text>\r\n        <input \r\n          type=\"password\" \r\n          v-model=\"formData.confirmPassword\" \r\n          placeholder=\"请再次输入密码\" \r\n          class=\"form-input\"\r\n        />\r\n      </view>\r\n      \r\n      <button @click=\"handleRegister\" class=\"register-btn\" :disabled=\"loading\">\r\n        {{ loading ? '注册中...' : '注册' }}\r\n      </button>\r\n      \r\n      <view class=\"login-link\">\r\n        <text>已有账户？</text>\r\n        <text @click=\"goToLogin\" class=\"link-text\">立即登录</text>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      formData: {\r\n        username: '',\r\n        password: '',\r\n        confirmPassword: '',\r\n        role: 'customer'  // 固定为普通用户\r\n      },\r\n      loading: false\r\n    };\r\n  },\r\n  onLoad() {\r\n    console.log('注册页面加载');\r\n  },\r\n  methods: {\r\n    validateForm() {\r\n      if (!this.formData.username.trim()) {\r\n        uni.showToast({ title: '请输入用户名', icon: 'none' });\r\n        return false;\r\n      }\r\n      \r\n      if (this.formData.username.length < 3) {\r\n        uni.showToast({ title: '用户名至少3个字符', icon: 'none' });\r\n        return false;\r\n      }\r\n      \r\n      if (!this.formData.password) {\r\n        uni.showToast({ title: '请输入密码', icon: 'none' });\r\n        return false;\r\n      }\r\n      \r\n      if (this.formData.password.length < 6) {\r\n        uni.showToast({ title: '密码至少6个字符', icon: 'none' });\r\n        return false;\r\n      }\r\n      \r\n      if (this.formData.password !== this.formData.confirmPassword) {\r\n        uni.showToast({ title: '两次密码不一致', icon: 'none' });\r\n        return false;\r\n      }\r\n      \r\n      return true;\r\n    },\r\n    \r\n    async handleRegister() {\r\n      console.log('开始注册');\r\n      if (!this.validateForm()) {\r\n        return;\r\n      }\r\n      \r\n      this.loading = true;\r\n      \r\n      try {\r\n        console.log('发送注册请求:', this.formData);\r\n        const res = await uni.request({\r\n          url: 'http://192.168.1.17:3000/api/users/register',\r\n          method: 'POST',\r\n          header: {\r\n            'Content-Type': 'application/json'\r\n          },\r\n          data: {\r\n            username: this.formData.username,\r\n            password: this.formData.password,\r\n            role: this.formData.role\r\n          }\r\n        });\r\n        \r\n        console.log('注册响应:', res);\r\n        \r\n        // 检查响应结构\r\n        const response = res[1] || res;\r\n        console.log('处理后的响应:', response);\r\n        \r\n        if (response && response.statusCode === 201) {\r\n          uni.showToast({ title: '注册成功', icon: 'success' });\r\n          \r\n          // 注册成功后跳转到登录页面\r\n          setTimeout(() => {\r\n            uni.navigateTo({\r\n              url: '/pages/account/login'\r\n            });\r\n          }, 1500);\r\n        } else {\r\n          const errorMsg = response && response.data && response.data.error ? response.data.error : '注册失败';\r\n          uni.showToast({ \r\n            title: errorMsg, \r\n            icon: 'none' \r\n          });\r\n        }\r\n      } catch (error) {\r\n        console.error('注册失败:', error);\r\n        uni.showToast({ title: '网络错误，请重试', icon: 'none' });\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    \r\n    goToLogin() {\r\n      uni.navigateTo({\r\n        url: '/pages/account/login'\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.register-container {\r\n  padding: 40rpx;\r\n  min-height: 100vh;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.register-header {\r\n  text-align: center;\r\n  margin-bottom: 60rpx;\r\n}\r\n\r\n.register-title {\r\n  font-size: 48rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.register-form {\r\n  background: white;\r\n  border-radius: 20rpx;\r\n  padding: 40rpx;\r\n  box-shadow: 0 4rpx 20rpx rgba(0,0,0,0.1);\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 40rpx;\r\n}\r\n\r\n.form-label {\r\n  display: block;\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  margin-bottom: 20rpx;\r\n  font-weight: 500;\r\n}\r\n\r\n.form-input {\r\n  width: 100%;\r\n  height: 80rpx;\r\n  border: 2rpx solid #e0e0e0;\r\n  border-radius: 10rpx;\r\n  padding: 0 20rpx;\r\n  font-size: 28rpx;\r\n  background-color: #fafafa;\r\n}\r\n\r\n.form-input:focus {\r\n  border-color: #3cc51f;\r\n  background-color: white;\r\n}\r\n\r\n.form-picker {\r\n  width: 100%;\r\n  height: 80rpx;\r\n  border: 2rpx solid #e0e0e0;\r\n  border-radius: 10rpx;\r\n  padding: 0 20rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  background-color: #fafafa;\r\n}\r\n\r\n.picker-text {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n}\r\n\r\n.register-btn {\r\n  width: 100%;\r\n  height: 88rpx;\r\n  background: #3cc51f;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 10rpx;\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  margin-top: 40rpx;\r\n}\r\n\r\n.register-btn[disabled] {\r\n  background: #ccc;\r\n}\r\n\r\n.login-link {\r\n  text-align: center;\r\n  margin-top: 40rpx;\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n.link-text {\r\n  color: #3cc51f;\r\n  margin-left: 10rpx;\r\n}\r\n</style> ","import MiniProgramPage from 'D:/newSunShinestore/frontend/newSunShineFrontend/pages/account/register.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAkDA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,UAAU;AAAA,QACR,UAAU;AAAA,QACV,UAAU;AAAA,QACV,iBAAiB;AAAA,QACjB,MAAM;AAAA;AAAA,MACP;AAAA,MACD,SAAS;AAAA;EAEZ;AAAA,EACD,SAAS;AACPA,kBAAAA,MAAA,MAAA,OAAA,oCAAY,QAAQ;AAAA,EACrB;AAAA,EACD,SAAS;AAAA,IACP,eAAe;AACb,UAAI,CAAC,KAAK,SAAS,SAAS,KAAI,GAAI;AAClCA,sBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,OAAK,CAAG;AAC/C,eAAO;AAAA,MACT;AAEA,UAAI,KAAK,SAAS,SAAS,SAAS,GAAG;AACrCA,sBAAG,MAAC,UAAU,EAAE,OAAO,aAAa,MAAM,OAAK,CAAG;AAClD,eAAO;AAAA,MACT;AAEA,UAAI,CAAC,KAAK,SAAS,UAAU;AAC3BA,sBAAG,MAAC,UAAU,EAAE,OAAO,SAAS,MAAM,OAAK,CAAG;AAC9C,eAAO;AAAA,MACT;AAEA,UAAI,KAAK,SAAS,SAAS,SAAS,GAAG;AACrCA,sBAAG,MAAC,UAAU,EAAE,OAAO,YAAY,MAAM,OAAK,CAAG;AACjD,eAAO;AAAA,MACT;AAEA,UAAI,KAAK,SAAS,aAAa,KAAK,SAAS,iBAAiB;AAC5DA,sBAAG,MAAC,UAAU,EAAE,OAAO,WAAW,MAAM,OAAK,CAAG;AAChD,eAAO;AAAA,MACT;AAEA,aAAO;AAAA,IACR;AAAA,IAED,MAAM,iBAAiB;AACrBA,oBAAAA,MAAY,MAAA,OAAA,oCAAA,MAAM;AAClB,UAAI,CAAC,KAAK,gBAAgB;AACxB;AAAA,MACF;AAEA,WAAK,UAAU;AAEf,UAAI;AACFA,sBAAY,MAAA,MAAA,OAAA,qCAAA,WAAW,KAAK,QAAQ;AACpC,cAAM,MAAM,MAAMA,cAAG,MAAC,QAAQ;AAAA,UAC5B,KAAK;AAAA,UACL,QAAQ;AAAA,UACR,QAAQ;AAAA,YACN,gBAAgB;AAAA,UACjB;AAAA,UACD,MAAM;AAAA,YACJ,UAAU,KAAK,SAAS;AAAA,YACxB,UAAU,KAAK,SAAS;AAAA,YACxB,MAAM,KAAK,SAAS;AAAA,UACtB;AAAA,QACF,CAAC;AAEDA,sBAAY,MAAA,MAAA,OAAA,qCAAA,SAAS,GAAG;AAGxB,cAAM,WAAW,IAAI,CAAC,KAAK;AAC3BA,sBAAA,MAAA,MAAA,OAAA,qCAAY,WAAW,QAAQ;AAE/B,YAAI,YAAY,SAAS,eAAe,KAAK;AAC3CA,wBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,UAAQ,CAAG;AAGhD,qBAAW,MAAM;AACfA,0BAAAA,MAAI,WAAW;AAAA,cACb,KAAK;AAAA,YACP,CAAC;AAAA,UACF,GAAE,IAAI;AAAA,eACF;AACL,gBAAM,WAAW,YAAY,SAAS,QAAQ,SAAS,KAAK,QAAQ,SAAS,KAAK,QAAQ;AAC1FA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,UACR,CAAC;AAAA,QACH;AAAA,MACA,SAAO,OAAO;AACdA,sBAAA,MAAA,MAAA,SAAA,qCAAc,SAAS,KAAK;AAC5BA,sBAAG,MAAC,UAAU,EAAE,OAAO,YAAY,MAAM,OAAK,CAAG;AAAA,MACnD,UAAU;AACR,aAAK,UAAU;AAAA,MACjB;AAAA,IACD;AAAA,IAED,YAAY;AACVA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACP,CAAC;AAAA,IACH;AAAA,EACF;AACF;;;;;;;;;;;;;;;;ACzJA,GAAG,WAAW,eAAe;"}